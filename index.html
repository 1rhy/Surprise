<!doctype html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Happy Birthday Joojak ðŸŽ‚</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&family=Vazirmatn:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg1:#f6eef6;
      --bg2:#eafaf9;
      --card:#fff8fb;
      --accent:#ff7fbf;
      --muted:#b88aa6;
      --text:#4a2240;
    }
    html,body{
      height:100%;
      margin:0;
      font-family:'Vazirmatn','Poppins',system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;
      direction:rtl;
      background:linear-gradient(160deg,var(--bg1),var(--bg2));
      -webkit-font-smoothing:antialiased;
    }
    .center{
      height:100%;
      display:flex;
      align-items:center;
      justify-content:center;
      flex-direction:column;
      gap:20px;
      padding:28px;
      box-sizing:border-box;
    }
    .headline{
      font-size:clamp(20px,4vw,42px);
      font-weight:800;
      color:var(--text);
      text-align:center;
      padding:18px 28px;
      border-radius:18px;
      background:linear-gradient(90deg,rgba(255,127,191,0.95),rgba(255,200,160,0.95));
      box-shadow:0 12px 40px rgba(79,28,59,0.08);
      backdrop-filter:blur(4px);
    }
    .stage{
      width:360px;
      max-width:88vw;
      height:420px;
      position:relative;
      display:grid;
      place-items:center;
    }
    .box-wrap{
      width:260px;
      height:260px;
      position:relative;
      perspective:1200px;
    }
    .box{
      width:100%;
      height:100%;
      position:relative;
      transform-style:preserve-3d;
      transition:transform 900ms cubic-bezier(.2,.9,.3,1);
    }
    .flap{
      position:absolute;
      background:linear-gradient(180deg,#ffdfee,#ffcbe6);
      box-shadow:0 8px 30px rgba(80,24,64,0.07);
      border-radius:12px;
      display:flex;
      align-items:center;
      justify-content:center;
      cursor:pointer;
    }
    .flap.top{left:16%;right:16%;top:0;height:46%;transform-origin:50% 0%}
    .flap.bottom{left:16%;right:16%;bottom:0;height:46%;transform-origin:50% 100%}
    .flap.left{top:16%;bottom:16%;left:0;width:46%;transform-origin:0% 50%}
    .flap.right{top:16%;bottom:16%;right:0;width:46%;transform-origin:100% 50%}
    .lid{
      position:absolute;
      inset:18%;
      background:var(--card);
      border-radius:12px;
      display:flex;
      align-items:center;
      justify-content:center;
      box-shadow:inset 0 -6px 14px rgba(0,0,0,0.03);
      z-index:3;
      font-weight:600;
      color:var(--muted);
    }
    .cake{
      position:absolute;
      left:50%;
      transform:translateX(-50%) translateY(110%);
      bottom:0;
      width:180px;
      height:160px;
      display:flex;
      align-items:flex-end;
      justify-content:center;
      flex-direction:column;
      gap:6px;
      transition:transform 700ms cubic-bezier(.2,.9,.2,1);
      z-index:2;
    }
    .layer{
      width:160px;
      height:36px;
      border-radius:12px;
      background:linear-gradient(180deg,#ffd0ea,#ff9acb);
      box-shadow:0 8px 20px rgba(0,0,0,0.08);
    }
    .frost{
      width:140px;
      height:26px;
      border-radius:12px;
      background:linear-gradient(180deg,#fffafc,#ffeef8);
    }
    .candles{
      display:flex;
      gap:10px;
      align-items:flex-end;
      justify-content:center;
      margin-top:6px;
    }
    .candle{
      width:10px;
      height:30px;
      background:#fff4e6;
      border-radius:4px;
      box-shadow:0 2px 6px rgba(0,0,0,0.06);
      position:relative;
    }
    .flame{
      position:absolute;
      top:-14px;
      left:50%;
      transform:translateX(-50%);
      width:12px;
      height:18px;
      border-radius:50%/60% 60% 40% 40%;
      background:linear-gradient(180deg,#ffd45b,#ff6b6b);
      filter:drop-shadow(0 2px 6px rgba(255,107,107,0.22));
    }
    .opened .flap.top{transform:rotateX(-86deg) translateY(-22px)}
    .opened .flap.bottom{transform:rotateX(86deg) translateY(22px)}
    .opened .flap.left{transform:rotateY(86deg) translateX(-22px)}
    .opened .flap.right{transform:rotateY(-86deg) translateX(22px)}
    .opened .cake{transform:translateX(-50%) translateY(-24%)}
    canvas.confetti-canvas{
      position:fixed;
      left:0;
      top:0;
      width:100vw;
      height:100vh;
      pointer-events:none;
      z-index:50;
    }
    .big-message{
      position:fixed;
      top:8vh;
      left:50%;
      transform:translateX(-50%);
      font-size:clamp(20px,5vw,44px);
      font-weight:700;
      color:#fff;
      padding:14px 26px;
      border-radius:20px;
      background:linear-gradient(90deg,#ff7bb8,#ffd29a);
      box-shadow:0 18px 60px rgba(255,123,184,0.14);
      opacity:0;
      transition:all 700ms cubic-bezier(.2,.9,.2,1);
      z-index:60;
    }
    .big-message.show{opacity:1;transform:translateX(-50%) scale(1)}
    .subtext{margin-top:12px;font-size:18px;color:var(--text);opacity:0.95}
    .hint{font-size:14px;color:rgba(74,34,64,0.55);margin-top:18px}
  </style>
</head>
<body>
  <div class="center">
    <div class="headline">Happy Birthday Joojak ðŸŽ‚</div>
    <div class="stage">
      <div class="box-wrap" id="boxWrap">
        <div class="box" id="box" role="button" tabindex="0" aria-label="Ø¨Ø§Ø² Ú©Ø±Ø¯Ù† Ø¬Ø¹Ø¨Ù‡ ØªÙˆÙ„Ø¯">
          <div class="flap top"></div>
          <div class="flap bottom"></div>
          <div class="flap left"></div>
          <div class="flap right"></div>
          <div class="lid">Ø¨Ø§Ø² Ú©Ù†!</div>
          <div class="cake" id="cake" aria-hidden="true">
            <div class="layer"></div>
            <div class="frost"></div>
            <div class="layer" style="width:140px;height:32px;border-radius:10px;"></div>
            <div class="candles">
              <div class="candle"><div class="flame"></div></div>
              <div class="candle"><div class="flame"></div></div>
              <div class="candle"><div class="flame"></div></div>
            </div>
          </div>
        </div>
      </div>
      <canvas class="confetti-canvas" id="confettiCanvas"></canvas>
    </div>
    <div class="subtext" id="subText">Ø¨Ø±Ø§ÛŒ JoojakØ› ÛŒÚ© Ø³ÙˆØ±Ù¾Ø±Ø§ÛŒØ² ØªÙˆÙ„Ø¯ ðŸŽ€</div>
    <div class="hint">Ø¨Ø±Ø§ÛŒ Ø¨Ø§Ø² Ú©Ø±Ø¯Ù† Ø±ÙˆÛŒ Ø¬Ø¹Ø¨Ù‡ Ú©Ù„ÛŒÚ© Ú©Ù† ðŸŽ‰</div>
  </div>
  <div class="big-message" id="bigMessage">Ø¨Ù‡ØªØ±ÛŒÙ† Ø¯ÙˆØ³Øª Ø¯ÙˆØ± Ø¯ÙˆØ±ÛŒ ðŸ’•</div>

  <audio id="birthdayAudio" preload="auto">
    <source src="happy_birthday.mp3" type="audio/mpeg">
    Ù…Ø±ÙˆØ±Ú¯Ø±ØªÙˆÙ† Ø§Ø² Ù¾Ø®Ø´ ØµÙˆØª Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ù†Ù…ÛŒâ€ŒÚ©Ù†Ù‡.
  </audio>

  <script>
    const canvas=document.getElementById('confettiCanvas');
    const ctx=canvas.getContext('2d');
    let W=canvas.width=innerWidth, H=canvas.height=innerHeight;
    window.addEventListener('resize', ()=>{W=canvas.width=innerWidth;H=canvas.height=innerHeight});
    const rand=(a,b)=>Math.random()*(b-a)+a;
    class Particle{constructor(x,y,angle,speed,size,color){this.x=x;this.y=y;this.vx=Math.cos(angle)*speed;this.vy=Math.sin(angle)*speed;this.size=size;this.color=color;this.life=0;this.ttl=rand(60,150)}
      update(){this.x+=this.vx;this.y+=this.vy;this.vy+=0.18;this.vx*=0.995;this.life++}
      draw(ctx){ctx.save();ctx.translate(this.x,this.y);ctx.rotate(this.life*0.06);ctx.fillStyle=this.color;ctx.fillRect(-this.size/2,-this.size/2,this.size,this.size);ctx.restore()}}
    let particles=[];
    function emitBurst(x,y,spread,count){
      const colors=['#ff6fb5','#ffd166','#ff9acb','#a0e7e5','#bdb2ff'];
      for(let i=0;i<count;i++){
        const a=rand(-spread,spread)*Math.PI/180 + rand(-0.35,0.35);
        const speed=rand(4,11);
        const size=Math.round(rand(6,12));
        particles.push(new Particle(x,y,a,speed,size,colors[Math.floor(rand(0,colors.length))]));
      }
    }
    function loop(){
      ctx.clearRect(0,0,W,H);
      for(let i=particles.length-1;i>=0;i--){
        const p=particles[i];p.update();p.draw(ctx);
        if(p.life>p.ttl||p.y>H+60)particles.splice(i,1)
      }
      requestAnimationFrame(loop);
    }
    loop();

    const box=document.getElementById('box');
    const boxWrap=document.getElementById('boxWrap');
    const bigMessage=document.getElementById('bigMessage');
    const audio=document.getElementById('birthdayAudio');
    const subText=document.getElementById('subText');
    let opened=false;
    function openBox(){
      if(opened) return; opened=true;
      boxWrap.classList.add('opened'); box.classList.add('opened');
      emitBurst(60,60,120,40); emitBurst(W-60,60,90,40);
      emitBurst(60,H-60,100,40); emitBurst(W-60,H-60,80,40);
      let bursts=0; const int=setInterval(()=>{emitBurst(rand(80,W-80),rand(80,H-80),120,18);bursts++; if(bursts>8) clearInterval(int)},300);
      bigMessage.classList.add('show');
      if(audio){ audio.currentTime=0; setTimeout(()=>{ audio.play().catch(()=>{}); }, 220); }
    }
    box.addEventListener('click', openBox);
    box.addEventListener('keydown', (e)=>{if(e.key==='Enter'||e.key===' '){e.preventDefault();openBox();}});
    document.addEventListener('touchstart', ()=>{if(opened&&audio&&audio.paused) audio.play().catch(()=>{});},{once:true});
  </script>
</body>
</html>
